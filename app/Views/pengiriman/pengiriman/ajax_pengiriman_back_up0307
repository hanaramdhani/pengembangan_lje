<?php

// print_r($layanan);
// print_r($jenis_kirim);
// print_r($pengiriman_detail);
// print_r($kirim_detail);
date_default_timezone_set('Asia/Jakarta');
if (isset($act) && $act == "view") {
    // print_r($pengiriman);
    $data_append = array();
    foreach ($pengiriman_detail as $key_row => $value_row) {
        $data_append["detail_" . $value_row->no_transaksi][] = $value_row;
    }
    $test = json_encode($data_append);

    // echo "<pre>";
    // print_r($pengiriman_detail);
    // echo "</pre>";
    ?>
    <div class="card">
        <div class="card-body">
            <a class="btn btn-primary" href="<?= site_url('load/add/pengiriman/pengiriman') ?>">
                <i class="fas fa-plus-circle"></i> Pengiriman Baru</a>
            </div>
        </div>
    </div>

    <div class="card card-outline card-danger">
        <div class="card-body">
            <table id="data-tampil" class="table table-striped" style="width:100%">
                <thead>
                    <tr class="text-center">
                        <th>No Transaksi</th>
                        <th>Transaksi Referensi</th>
                        <th>Customer</th>
                        <th>Jenis Bayar</th>
                        <th>No. Rekening</th>
                        <th>Divisi</th>
                        <th>Lokasi Asal</th>
                        <th>Lokasi Tujuan</th>
                        <th>Layanan</th>
                        <!-- <th>Diskon</th> -->
                    <!-- <th>Nama Pengirim</th>
                    <th>Nama Penerima</th>
                    <th>Alamat Pengirim</th>
                    <th>Alamat Penerima</th>
                    <th>NO. Tlp Pengirim</th>
                    <th>No. Tlp Penerima</th>
                    <th>Nomor</th>
                    <th>Tanggal</th>
                    <th>status</th>
                    <th>Lama Kredit</th>
                    <th>Diskon</th>
                    <th>Keterangan</th>
                    <th>Lampiran</th>
                    <th>User</th>-->
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <?php foreach ($pengiriman as $key => $value) : ?>

                    <tr>
                        <td><button type="button" class="btn btn-info btn-xs data-tampil text-left"
                            data-key="<?= $value->no_transaksi ?>" data-layanan="<?= $value->kd_layanan ?>"
                            data-kota_asal="<?= $value->kd_lokasi_asal ?>"
                            data-kota_tujuan="<?= $value->kd_lokasi_tujuan ?>">
                            <i class="fa fa-eye"></td>
                                <td><?= $value->no_transaksi_reff ?></td>
                                <td><?= $value->customer ?></td>
                                <td><?= $value->jenis_bayar ?></td>
                                <td><?= $value->kas ?></td>
                                <td><?= $value->divisi ?></td>
                                <td><?= $value->asal ?></td>
                                <td><?= $value->tujuan ?></td>
                                <td><?= $value->layanan ?></td>
                                <!-- <td><?= $value->diskon ?></td> -->
                    <!-- <td><?= $value->nama_pengirim ?></td>
                        <td><?= $value->nama_penerima ?></td>
                        <td><?= $value->alamat_pengirim ?></td>
                        <td><?= $value->alamat_penerima ?></td>
                        <td><?= $value->no_hp_pengirim ?></td>
                        <td><?= $value->no_hp_penerima ?></td>
                        <td><?= $value->nomor ?></td>
                        <td><?= $value->tanggal ?></td>
                        <td><?= $value->status ?></td>
                        <td><?= $value->lama_kredit ?></td>
                        <td><?= $value->diskon ?></td>
                        <td><?= $value->keterangan ?></td>
                        <td><?= $value->lampiran ?></td>
                        <td><?= $value->kd_user ?></td> -->

                        <td class="text-center" width="160px">
                            <a href="<?= site_url('load/edit/pengiriman/pengiriman/') . $value->no_transaksi ?>"
                                class="btn btn-warning btn-xs" data-key="<?= $value->no_transaksi ?>"><i
                                class="fa fa-edit"></i></a>
                                <button class="btn btn-xs btn-danger delete" data-key="<?= $value->no_transaksi ?>"> <i
                                    class="fa fa-trash"></i></button>

                                    <button class="btn btn-xs show-image <?= $value->lampiran != '' ? 'btn-info' : 'btn-secondary disabled' ?>" data-toggle="tooltip" data-placement="bottom" title="Lihat Gambar" data-src="<?= base_url("/img/$page/" . $value->lampiran) ?>">
                                        <i class=" fa fa-image"></i>
                                    </button>

                        <!-- edit modal
                            <button type="button" class="btn btn-warning btn-xs edit-master"
                                data-key="<?= $value->no_transaksi ?>">
                                <i class="fa fa-edit"></i>
                            </button> -->

                        </td>
                    </tr>
                <?php endforeach ?>
            </tbody>
        </table>
    </div>
</div>

<script>
    $(document).ready(function() {
        $('#data-tampil').DataTable();
    });
    $('.show-image').click(function() {
        let url = $(this).data('src');
        $('#imagepreview').attr('src', url);
        $('#imagepreview').addClass('after-load');
        $('#imagepreview').removeClass('before-load');
        $('#imagemodal').modal('show');
    });
</script>

<script type="text/javascript">
    function format(data, layanan, kota_asal, kota_tujuan) {

        let pengiriman_detail = <?= (!empty($test)) ? $test : '' ?>['detail_' + data];
        console.log(pengiriman_detail);
        let content = ``;
        if (pengiriman_detail != "") {
            for (var i = 0; i < pengiriman_detail.length; i++) {
                content += `
                <tr style="background-color:azure">
                <td>` + (i + 1) + `</td>
                <td>` + pengiriman_detail[i]['jenis_kirim'] + `</td>
                <td>` + pengiriman_detail[i]['panjang'] + `</td>
                <td>` + pengiriman_detail[i]['lebar'] + `</td>
                <td>` + pengiriman_detail[i]['tinggi'] + `</td>
                <td>` + pengiriman_detail[i]['jumlah_berat'] + `</td>
                <td>` + pengiriman_detail[i]['diskon'] + `</td>
                <td>` + pengiriman_detail[i]['harga_berat'] + `</td>
                <td>` + pengiriman_detail[i]['harga_volume'] + `</td>
                <td>` + pengiriman_detail[i]['harga_koli'] + `</td>
                <td>` + pengiriman_detail[i]['jumlah_item'] + `</td>
                </tr>
                `;
            //     <td>
            //     <button class="btn btn-xs btn-warning" onclick="edit_pengiriman_detail(` +
            // pengiriman_detail[i]['nomor'] + `,'` + layanan + `','` + `${kota_asal}','${kota_tujuan}` + `','` +
            // pengiriman_detail[i]['kd_jenis'] + `')"><i class="fa fa-edit"></i></button>
            // </td>
        }
    }
    let html_content = `<div class="slider container-fluid" name>
    <table class="table table-responsive table-condensed" style="opacity:0.9">
    <tr>
    <th>#</th>
    <td>Jenis Kirim</td>
    <td>Panjang</td>
    <td>Lebar</td>
    <td>Tinggi</td>
    <td>Berat</td>
    <td>Diskon</td>
    <td>Harga Berat</td>
    <td>Harga Volume</td>
    <td>Harga Koli</td>
    <td>Jumlah Item</td>
    </tr>
    ` + content + `
    </table>
    </div>`;
    // console.log(html_content);
    return html_content;

}

$("#data-tampil").on('click', '.data-tampil', function() {
    var table = $('#data-tampil').DataTable();
    var tr = $(this).closest('tr');
    var row = table.row(tr);
    var layanan = $(this).data('layanan');
    var kota_asal = $(this).data('kota_asal');
    var kota_tujuan = $(this).data('kota_tujuan');

    if (row.child.isShown()) {
        // This row is already open - close it
        $('div.slider', row.child()).slideUp(function() {
            row.child.hide();
            tr.removeClass('shown');
        });
    } else {
        row.child(format($(this).data('key'), layanan, kota_asal, kota_tujuan)).show();
        tr.addClass('shown');
        $('div.slider', row.child()).slideDown();
    }
});
$("#data-tampil").on('click', '.edit-master', function() {
    let key_update = $(this).data('key');
    $.ajax({
        type: 'POST',
        url: `<?= base_url() ?>/ajax_load/edit/pengiriman/pengiriman/` + key_update + `/true`,
        success: function(r) {
            $('#m-crud-title').text('Edit Pengiriman');
            $('#m-crud-key').text(key_update);
            $('#m-crud-act').text('edit');
            $('#m-crud-page').text('pengiriman');
            $('#m-crud-jenis').text('master');
            $('#m-container-crud').html(r);
            $('#modal-crud').modal('show');
        }
    });
    if (row.child.isShown()) {
        // This row is already open - close it
        $('div.slider', row.child()).slideUp(function() {
            row.child.hide();
            tr.removeClass('shown');
        });
    } else {
        row.child(format($(this).data('key'))).show();
        tr.addClass('shown');
    }
});

function edit_pengiriman_detail(key_update, kd_layanan, kd_kota_asal, kd_kota_tujuan, kd_jenis) {
    // console.log(kd_layanan);
    // $.ajax({
    //     type: 'POST',
    //     url: `<?= base_url() ?>/ajax_load/edit/pengiriman_detail/pengiriman/` + key_update + `/true`,
    //     success: function(r) {
    //         alert('ss')
    //         $('#m-crud-title').text('Edit Detail Pengiriman');
    //         $('#m-crud-key').text(key_update);
    //         $('#m-crud-act').text('edit');
    //         $('#m-crud-page').text('pengiriman_detail');
    //         $('#m-crud-jenis').text('master');
    //         $('#m-container-crud').html(r);
    //         $('#modal-crud').modal('show');
    //         $('#hrg_volume').change(function() {
    //             volume();

    //         });

    //     }

    // })
    $.ajax({
        type: 'POST',
        url: `<?= base_url() ?>/api/get_min/${kd_kota_asal}/${kd_kota_tujuan}/${kd_jenis}/${kd_layanan}/${key_update}`,
        data: {
            token: 123,
        },
        // dataType: 'JSON',
        success: function(r) {
            $('#m-crud-title').text('Edit Detail Pengiriman');
            $('#m-crud-key').text(key_update);
            $('#m-crud-act').text('edit');
            $('#m-crud-page').text('pengiriman_detail');
            $('#m-crud-jenis').text('master');
            $('#m-container-crud').html(r);
            $('#modal-crud').modal('show');
            $('#hrg_volume').change(function() {
                volume();
            });

        }
    });
};

$('.delete').on('click', function() {
    let key_delete = $(this).data('key');
    Swal.fire({
        title: '?',
        text: "Apakah anda Yakin?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Ya',
        cancelButtonText: 'Tidak'
    }).then((result) => {
        if (result.value) {
            $.ajax({
                type: 'POST',
                url: `<?= base_url() ?>/api/delete/` + key_delete,
                data: `frm_table=pengiriman&token=123`,
                dataType: 'json',
                success: function(r) {
                    // alert(r.status);
                    if (r.status == 200) {
                        tes_sweet('hapus data berhasil');
                        first_load();
                        // first_load();
                    }
                }
            });
        }
    })
});
</script>

<?php
} elseif (isset($act) && $act == "add" && !$modal) {
    // print_r($get_ready_ongkir);
    $kota_asal = array();
    $kota_tujuan = array();
    $layanan = array();
    $jenis_kirim_t = array();
    $jenis_kirim_js = array();
    foreach ($jenis_kirim as $key_row => $value_row) {
        $jenis_kirim_js["detail_" . $value_row->kd_jenis] = $value_row->nama;
    }
    $arr_jenis_kirim = json_encode($jenis_kirim_js);
    // print_r($arr_jenis_kirim);
    foreach ($get_ready_ongkir as $key => $value) {
        $kota_asal[$value->kd_kota_asal] = (object)['kd_lokasi' => $value->kd_kota_asal, "nama" => $value->kota_asal];
        // $m_kota_asal[$value->kd_kota_asal]=;
        $kota_tujuan[$value->kd_kota_tujuan] = (object)['kd_lokasi' => $value->kd_kota_tujuan, "nama" => $value->kota_tujuan];
        $layanan[$value->kd_layanan] = (object)['kd_layanan' => $value->kd_layanan, "nama" => $value->layanan];
        $jenis_kirim_t[$value->kd_jenis] = (object)['kd_jenis' => $value->kd_jenis, "nama" => $value->jenis_kirim];
    }
    ?>

    <div class="card card-outline card-danger">
        <div class="card-body">

            <form class="form-horizontal" id="frm-pengiriman">
                <div class="card-body">
                    <div class="tab-content" id="tab-pengirimanContent">
                        <!-- form data pengiriman -->


                        <input type="hidden" name="val_tanggal" class="data" value="<?= date('Y-m-d H:i:s') ?>">

                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="control-label">Lokasi asal</label>
                                    <input type="text" class="form-control data" name="val_kd_lokasi_asal" id="kota-asal"
                                    placeholder="Area pengirim" required>
                                    <!-- <div> -->
                                        <div id="kota-asal-list" style="z-index: 999;" class="position-relative"></div>
                                        <!-- </div> -->
                                        <input type="hidden" id="kd-lokasi_asal" name="val_kd_lokasi_asal">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="control-label">Lokasi Tujuan</label>
                                        <input type="text" class="form-control data" id="kota-tujuan"
                                        name="val_kd_lokasi_tujuan" placeholder="Area penerima" required>
                                        <div id="kota-tujuan-list" style="z-index: 999;" class="position-relative">
                                        </div>
                                        <input type="hidden" id="kd-lokasi_tujuan" name="val_kd_lokasi_tujuan">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="control-label">Jenis Layanan</label>
                                        <select name="val_kd_layanan" id="layanan" param="val_kd_layanan"
                                        class="form-control data-dt select2">
                                        <?php foreach ($layanan as $ly => $value) : ?>
                                            <option value="<?php echo $value->kd_layanan; ?>">
                                                <?php echo $value->nama ?>
                                            </option>
                                        <?php endforeach; ?>
                                    </select>
                                    <!-- mengambil kd_layanan -->
                                    <input type="hidden" id="lyn">
                                    <script type="text/javascript">
                                        $('#layanan').click(function() {
                                            document.getElementById('lyn').value = document.getElementById(
                                                'layanan').value;
                                        });
                                    </script>

                                </div>
                            </div>
                        </div>

                        <hr />
                        <div class="row">
                            <div class="col-md-4">
                                <div class=" form-group">
                                    <label class="control-label">Kode Referensi</label>
                                    <input type="text" class="form-control data" id="val_no_transaksi_reff"
                                    name="val_no_transaksi_reff" value="-" required>
                                </div>
                                <div class="form-group">
                                    <label class="control-label">KAS</label>
                                    <select name="val_kd_kas" id="val_kd_kas" class="form-control data">
                                        <?php foreach ($kas as $k => $value) : ?>
                                            <option value="<?php echo $value->kd_kas; ?>">
                                                <?php echo $value->no_rekening ?>
                                            </option>
                                        <?php endforeach; ?>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="control-label">Divisi</label>
                                    <select name="val_kd_divisi" id="val_kd_divisi" param="val_kd_divisi"
                                    class="form-control data">
                                    <?php foreach ($divisi as $d => $value) : ?>
                                        <option value="<?php echo $value->kd_divisi ?>"
                                            <?= ($value->kd_divisi == $_SESSION['kd_divisi']) ? 'selected' : '' ?>>
                                            <?php echo $value->nama ?>
                                        </option>
                                    <?php endforeach; ?>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group row">
                                <label for="val_status" class="col-sm-7 col-form-label">Status</label>
                                <div class="col-sm-6" id="radio-aktif">
                                    <input type='radio' class="form-check-label" name="val_status" onclick="coba()"
                                    value="1" checked>
                                    <label class="form-check-label">Tunai</label>
                                </div>
                                <div class="col-sm-6" id="radio-aktif1">
                                    <input type='radio' name="val_status" onclick="coba1()" value="0">
                                    <label class="form-check-label">Kredit</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Jenis Pembayaran</label>
                                <select name="val_kd_jenis_bayar" param="val_kd_jenis_bayar"
                                class="form-control data select2">
                                <?php foreach ($jenis_bayar as $cs => $value) : ?>
                                    <option value="<?php echo $value->kd_jenis_bayar; ?>">
                                        <?php echo $value->nama ?>
                                    </option>
                                <?php endforeach; ?>
                            </select>
                        </div>
                        <div class="form-group">
                            <label style="display: none;" id="lbl-lm" class="col-sm-7 col-form-label">Lama
                            Kredit</label>
                            <input type="hidden" class="form-control data" id="lama-kredit" name="val_lama_kredit"
                            placeholder="Masukkan Lama Kredit" value="0" required>
                        </div>
                        <div class="form-group row">
                            <label style="display: none;" class="col-sm-7 col-form-label">Diskon</label>
                            <div class="col-sm-10">
                                <div class="row">
                                    <div class="col-md-6">
                                        <input style="display: none;" type="number" min="0"
                                        class="form-control data data-dt" id="val_diskon_t"
                                        oninput="Check(this)" param="val_diskon_t" maxlength="3" max="99"
                                        name="val_diskon" readonly placeholder="Masukkan Diskon"
                                        onkeyup="total()" value="0">
                                    </div>
                                    <div class="col-md-3">
                                        <button style="display: none;" id="persen_master"
                                        class="btn btn-secondary w-80">%</button>
                                    </div>
                                    <div class="col-md-3">
                                        <button style="display: none;" id="rupiah_master"
                                        class="btn btn-secondary w-80">Rp.</button>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="control-label">Keterangan</label>
                            <textarea id="val_keterangan" name="val_keterangan" param="val_keterangan"
                            style="height:80px" class="form-control data"
                            placeholder="Masukkan Keterangan"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="subject">Lampiran</label>
                            <div class="col pl-0 mb-2">
                                <div class="img-preview">
                                    <img id="lampiran" src="/assets/dist/img/fa-solid_image.png" class="w-100 p-4">
                                </div>
                            </div>
                            <div class="col pl-0">
                                <input type="file" name="val_lampiran" id="val_lampiran" param="val_lampiran"
                                class="data" onchange="addlamp()">
                            </div>
                        </div>
                        <script>
                            function addlamp() {
                                let frame = document.getElementById('lampiran');
                                frame.src = URL.createObjectURL(event.target.files[0]);
                            }
                        </script>
                    </div>
                </div>
                <!-- </div> -->



                <!-- pengirim dan penerima -->

                <hr />
                <div class="row">
                    <div class="col-md-6">
                        <div class="d-flex align-items-center mb-0">
                            <input type="hidden" class="form-control data" id="val_kd_customer"
                            name="val_kd_customer" value="-1">

                            <h3 class="mr-3 mb-0">
                                Data Pengirim 
                            </h3>

                            <div class="">
                                <button type="button" class="btn btn-outline-success btn-xs call-modal"
                                id="pengirim"><span id="pengirim-text">Tunai</span> <i class="fa fa-sync-alt pl-2" aria-hidden="true"></i></button>
                            </div>

                        </div>
                        <div class="mb-3" style="color: green"><input type="radio" name="checked_customer" class="checked-customer" value="pengirim" checked> Set Sebagai Customer</div>
                        <div class=" form-group row">
                            <label class="col-sm-7 col-form-label">Nama</label>
                            <div class="col-sm-10">
                                <input type="hidden" id="kd-selected-pengirim" value="-1">
                                <input type="text" class="form-control data" id="val_nama_pengirim"
                                param="val_nama_pengirim" name="val_nama_pengirim" placeholder="Nama pengirim" value="Tunai - Mataram" 
                                required>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="subject" class="col-sm-7 col-form-label">Alamat</label>
                            <div class="col-sm-10">
                                <textarea id="val_alamat_pengirim" name="val_alamat_pengirim"
                                param="val_alamat_pengirim" class="form-control data"
                                placeholder="Alamat pengirim">Mataram</textarea>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="inputPassword3" class="col-sm-7 col-form-label">No. Hp</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control data" id="val_hp_pengirim"
                                name="val_no_hp_pengirim" placeholder="No. HP pengirim" value="-">
                            </div>
                        </div>

                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-center">
                            <h3 class="mr-3 mb-0">Data Penerima</h3>
                            <div>
                                <button type="button" class="btn btn-outline-success btn-xs call-modal"
                                id="penerima"><span id="penerima-text">Pilih dari Customer</span> <i class="fa fa-sync-alt pl-2" aria-hidden="true"></i></button>
                            </div>

                        </div>
                        <div class="mb-3" style="color: green"><input type="radio" name="checked_customer" class="checked-customer" value="penerima"> Set Sebagai Customer</div>
                        <div class=" form-group row">
                            <label class="col-sm-7 col-form-label">Nama</label>
                            <div class="col-sm-10">
                                <input type="hidden" id="kd-selected-penerima" value="-1">
                                <input type="text" class="form-control data" id="val_nama_penerima"
                                name="val_nama_penerima" param="val_nama_penerima" placeholder="Nama penerima"
                                required>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="subject" class="col-sm-7 col-form-label">Alamat</label>
                            <div class="col-sm-10">
                                <textarea id="val_alamat_penerima" name="val_alamat_penerima"
                                param="val_alamat_penerima" class="form-control data"
                                placeholder="Alamat penerima"></textarea>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="inputPassword3" class="col-sm-7 col-form-label">No. Hp</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control data" id="val_hp_penerima"
                                name="val_no_hp_penerima" placeholder="No. HP penerima">
                            </div>
                        </div>


                    </div>

                </div>

                <!-- </div> -->
                <style>
                    .autocomplete_li:hover {
                        background-color: #dc3545;
                    }
                </style>
                <script type="text/javascript">
                    $('.checked-customer').click(function(){
                        if ($(this).is(':checked') ) {
                            if ($(this).val() == 'pengirim') {
                                $('#val_kd_customer').val($('#kd-selected-pengirim').val())
                            }else{
                                $('#val_kd_customer').val($('#kd-selected-penerima').val())
                            }
                        }
                    });
                    function cek_selected_customer(){
                        let selected_customer=$("input[name='checked_customer']:checked").val();
                        if (selected_customer=="pengirim") {
                            $('#val_kd_customer').val($('#kd-selected-pengirim').val())
                        }else{
                            $('#val_kd_customer').val($('#kd-selected-penerima').val())
                        }
                    }
                    function coba() {
                        // $('#lama-kredit').prop('readonly', true);
                        $('#lama-kredit').attr('type', 'hidden');
                        // $('#lbl-lm').attr('type', 'hidden')
                        $('#lbl-lm').hide();

                    }

                    function coba1() {
                        // $('#lama-kredit').prop('readonly', false);
                        // $('#lbl-lm').attr('type', 'hidden');
                        $('#lama-kredit').attr('type', 'text');
                        $('#lama-kredit').attr('value', '')
                        // $('#lama-kredit').attr('style', 'display', false);
                        $('#lbl-lm').show();
                    }

                    $(document).ready(function() {

                        get_rp();
                    })
                    $(document).ready(function() {
                        $('#kota-asal').keyup(function() {
                            var query = $(this).val();
                            if (query != '') {
                                $.ajax({
                                    method: "POST",
                                    url: `<?= base_url() ?>/api/lokasi`,
                                    data: {
                                        token: '123',
                                        search_key: query,
                                        find_type: 'kota_asal',
                                        find_condition: $('#kota-tujuan').val()
                                    },
                                    success: function(r) {
                                        console.log(r);

                                        $('#kota-asal-list').html(r);
                                        $('#kota-asal-list').fadeIn();
                                        set_autocomplete_id(query,
                                            'kota-asal');
                                    }
                                });
                            } else {
                                $('#kota-asal-list').fadeOut();
                            }
                        });
                        $('#kota-tujuan').keyup(function() {
                            var query = $(this).val();
                            if (query != '') {
                                $.ajax({
                                    url: `<?= base_url() ?>/api/lokasi`,
                                    method: "POST",
                                    data: {
                                        token: '123',
                                        search_key: query,
                                        find_type: 'kota_tujuan',
                                        find_condition: $('#kota-asal').val()
                                    },
                                    success: function(r) {
                                        console.log(r);

                                        $('#kota-tujuan-list').html(r);
                                        $('#kota-tujuan-list').fadeIn();
                                        set_autocomplete_id(query, 'kota-tujuan');
                                    }
                                });
                            } else {
                                $('#kota-tujuan-list').fadeOut();
                            }
                        });
                        $(document).on('click', '.li-kota-asal', function() {
                            $('#kota-asal').val($(this).text());
                            $('#kd-lokasi_asal').val($(this).data('key'));
                            $('#kota-asal-list').fadeOut();
                            get_jenis_kirim();
                        });
                        $(document).on('click', '.li-kota-tujuan', function() {
                            $('#kota-tujuan').val($(this).text());
                            $('#kd-lokasi_tujuan').val($(this).data('key'));
                            $('#kota-tujuan-list').fadeOut();
                            get_jenis_kirim();
                        });


                        function set_autocomplete_id(search, type) {
                            $('.autocomplete_li').each(function() {
                                if ($(this).text().toUpperCase() == search.toUpperCase()) {
                                    $('#kd-' + type).val($(this).data('key'));
                                    $('#' + type).val($(this).text());
                                    $('#' + type + '-list').fadeOut();
                                    get_jenis_kirim();
                                } else {
                                    $('#kd-' + type).val('');
                                }
                            });
                        }
                    });
                </script>

                <hr />
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="form-label">Jenis Kirim</label>
                            <select id="val-kd-jenis" name="val_kd_jenis" param="val_kd_jenis"
                            class="form-control data-dt ongkir select2" required>
                            <?php foreach ($jenis_kirim_t as $jk => $value) : ?>
                                <option class="jenis_krm" value="<?php echo $value->kd_jenis; ?>">
                                    <?php echo $value->nama ?>
                                </option>
                            <?php endforeach; ?>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Jumlah Item</label>
                        <input type="text" name="val_jumlah_item" id="jumlah-item" value="0"
                        param="val_jumlah_item" class="form-control data-dt" onkeyup="resultsubtotal()"
                        placeholder="Masukkan Jumlah Item">
                                <!-- <input type="text" class="data-dt" onkeyup="resultsubtotal()" param="val_harga_koli"
                                    id="harga_koli"> -->
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Harga Koli</label>
                                <!-- <input type="text" id="jumlah-item" param="val_jumlah_item"
                                    class="form-control data-dt" onkeyup="resultsubtotal()"> -->
                                    <div class="input-group">
                                        <div class="input-group-append">
                                            <span class="input-group-text">Rp.</span>
                                        </div>
                                        <input type="text" class="form-control data-dt" onkeyup="resultsubtotal()"
                                        name="val_harga_koli" value="0" param="val_harga_koli" id="harga_koli" readonly>
                                    </div>
                                </div>
                                <input type="hidden" id="jenis_k">
                                <div id="jenis-kirim-container"></div>
                                <script type="text/javascript">
                                    function get_jenis_kirim() {
                                        let option = ``;
                                        $.ajax({
                                            type: 'POST',
                                            url: `<?= base_url() ?>/api/get_jenis_kirim`,
                                            data: {
                                                layanan: $("#layanan").val(),
                                                kd_kota_asal: $('#kd-lokasi_asal').val(),
                                                kd_kota_tujuan: $('#kd-lokasi_tujuan')
                                                .val(),
                                                token: 123,
                                            },
                                            success: function(r) {
                                                if (r == '') {
                                                    option += `<option value="">Pilih Lokasi</option>`;
                                                } else {
                                                    option += `<option value="">Pilih Jenis</option>`;
                                                    option += r;
                                                    $('#val-kd-jenis').html(option);
                                                }
                                            }
                                        });
                                    }

                                    function get_layanan() {
                                        let option = ``;
                                        $.ajax({
                                            type: 'POST',
                                            url: `<?= base_url() ?>/api/get_layanan`,
                                            data: {
                                                jenis_kirim: $("#val-kd-jenis").val(),
                                                kd_kota_asal: $('#kd-lokasi_asal').val(),
                                                kd_kota_tujuan: $('#kd-lokasi_tujuan').val(),
                                                token: 123,
                                            },
                                            success: function(r) {
                                                if (r == '') {
                                                    option += `<option value="">Pilih Lokasi</option>`;
                                                } else {
                                                    option += `<option value="">Pilih Layanan</option>`;
                                                    option += r;
                                                    $('#layanan').html(option);
                                                }
                                            }
                                        });
                                    }
                                    $('.select2').select2();

                                    $('#val-kd-jenis').change(function() {
                                        if ($(this).val() != '') {
                                            document.getElementById('jenis_k').value =
                                            document.getElementById('val-kd-jenis').value;
                                            $.ajax({
                                                type: 'POST',
                                                url: `<?= base_url() ?>/api/get_ongkir`,
                                                data: {
                                                    layanan: $("#layanan").val(),
                                                    lokasi_asal: $('#kd-lokasi_asal').val(),
                                                    lokasi_tujuan: $('#kd-lokasi_tujuan').val(),
                                                    jenis_kirim: $('#jenis_k').val(),
                                                    token: 123
                                                },
                                                dataType: 'JSON',
                                                success: function(r) {
                                                    console.log(r);
                                                    $('#label_harga_berat').html("Rp. " +
                                                        currencyFormat(parseFloat(r.harga_berat)));
                                            // alert(r.harga_berat);
                                            $('#label_min_berat').html("Minimum Berat : " +
                                                r.min_berat + " kg");
                                            $('#label_harga_volume').html("Rp. " + currencyFormat(
                                                parseFloat(r.harga_volume)));
                                            $('#label_min_volume').html("Minimum Volume : " +
                                                r.min_volume + " ");
                                            $('#val_harga_berat').val(r.harga_berat);
                                            $('#val_harga_volume').val(r.harga_volume);
                                            $('#min').val(r.min_berat);
                                            $('#min_volum').val(r.min_volume);
                                            $('#harga_koli').val(
                                                currencyFormat(parseFloat(r.harga_koli)));
                                            resultberat();
                                            // volume();
                                            // resultvolume();
                                            // resultsubtotal();
                                            get_rp();
                                            // total();

                                            // $('#harga_koli').val(this(currencyFormat()));
                                        }
                                    });
                                        }
                                    });

                                    $('#butonn').click(function() {
                                        $.ajax({
                                            type: 'POST',
                                            url: `<?= base_url() ?>/api/get_customer/`,
                                            data: {
                                                token: 123,
                                                kd_customer: $('#cari').val(),
                                            },
                                    // dataType: 'JSON',
                                    success: function(r) {
                                        $('#m-container-panggil').html(r);
                                        // $('#cari').append(this['nama']);
                                    }
                                });
                                    });

                                    $('.call-modal').click(function() {
                                        let key = $(this).data('key');
                                        let page = `<?= $page ?>`;
                                        let jenis = `pengiriman`;
                                        let jenis_modal = $(this).attr('id');
                                        let act = "add";
                                        let title_modal = "";
                                        $('#start-customer').val(0);
                                        $.ajax({
                                            type: 'POST',
                                            url: `<?= base_url() ?>/api/ajax_load_customer/0`,
                                            data:{token:`<?=$_SESSION['token']?>`,file_name:`pengiriman/pengiriman/ajax_pengiriman`,page:page,jenis:jenis,act:act},
                                            success: function(r) {
                                                $('#m-crud-title-panggil').text(title_modal);
                                                $('#m-customer').text(jenis_modal);
                                                $('#m-container-panggil').html(r);
                                                $('#modal-panggil').modal('show');
                                                $('#start-customer').val(10);
                                            }
                                        });
                                    });
                                </script>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Berat (kg)</label> <span style="font-size: 14px;" id="label_min_berat"></span>
                                    <div class="row align-items-center">
                                        <input type="hidden" value="0" class="data-dt" id="val_harga_berat"
                                        name="val_harga_berat" param="val_harga_berat" onkeyup="resultberat()">
                                        <input type="hidden" value="0" id="min" onkeyup="resultberat()">


                                        <div class="input-group">
                                            <div class="input-group-append">
                                                <span id="label_harga_berat" class="input-group-text"> Rp. </span>
                                            </div>
                                            <input type="text" value="0" id="val_jumlah_berat" param="val_jumlah_berat"
                                            name="val_jumlah_berat" class="data-dt form-control"
                                            placeholder="Masukkan berat" value="" onkeyup="resultberat()">

                                        </div>
                                        <input type="hidden" class="data-dt" value="0" id="harga_berat" param="harga_berat"
                                        onkeyup="resultsubtotal()">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Dimensi</label>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <input type="text" class="form-control data-dt" value="0" id="val_panjang"
                                            param="val_panjang" name="val_panjang" placeholder="Panjang"
                                            onkeyup="volume()">
                                        </div>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control data-dt" value="0" id="val_lebar"
                                            param="val_lebar" name="val_lebar" placeholder="Lebar" onkeyup="volume()">
                                        </div>
                                        <div class="col-md-4">


                                            <input type="text" class="form-control data-dt" id="val_tinggi"
                                            param="val_tinggi" value="0" name="val_tinggi" placeholder="Tinggi"
                                            onkeyup="volume()">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Volume (<span class="min-volume"></span>&#13221;)</label>
                                    <span class="min-volume" style="font-size: 14px;" id="label_min_volume"></span>
                                    <div class="row align-items-center">
                                        <div class="input-group">
                                            <div class="input-group-append">
                                                <span id="label_harga_volume" class="input-group-text">Rp. </span>
                                            </div>
                                            <input type="text" value="0" class="form-control data-dt" id="hrg_volume"
                                            name="hrg_volume" value="" readonly value="">
                                        </div>




                                        <div>
                                            <!-- <label>hidden</label> -->
                                            <input type="hidden" value="0" id="val_harga_volume" param="val_harga_volume"
                                            onkeyup="resultvolume()" class="data-dt" name="val_harga_volume"
                                            onchange="resultvolume()">
                                            <input type="hidden" value="0" id="min_volum" onkeyup="resultvolume()">
                                        </div>
                                    <!-- <div class="col-md-6">
                                        <label id="label_harga_volume" class="form-label"></label>
                                    </div> -->
                                    <div>
                                        <!-- <label>hidden</label> -->
                                        <input type="hidden" value="0" id="harga_volume" class="data-dt"
                                        param="harga_volume" onkeyup="resultsubtotal()">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="form-label">Subtotal</label>
                                <div class="input-group">
                                    <div class="input-group-append">
                                        <span class="input-group-text">Rp. </span>
                                    </div>
                                    <input type="text" class="form-control data-dt number-format" value="0"
                                    id="val_subtotal" param="val_subtotal" readonly>
                                </div>
                            </div>
                            <div class="form-group">
                                <input type="hidden" value="0" id="discount-val" name="diskon" param="val_diskon"
                                class="data-dt">
                                <label class="form-label">Diskon</label>
                                <div class="input-group">
                                    <input type="number" min="0" maxlength="" oninput="Check(this)" class="form-control"
                                    id="diskon" onkeyup="total()" value="0" readonly placeholder="Diskon"
                                    aria-label="Recipient's username with two button addons">
                                    <button class="btn btn-outline-secondary" id="persen" type="button">%</button>
                                    <button class="btn btn-outline-secondary" id="rupiah" type="button">Rp.</button>
                                </div>
                            </div>
                            <script type="text/javascript">

                            </script>

                            <div class="form-group">
                                <label class="form-label">Total</label>
                                <div class="input-group">
                                    <div class="input-group-append">
                                        <span class="input-group-text">Rp.</span>
                                    </div>
                                    <input type="text" class="form-control data-dt" value="0" id="val_total"
                                    name="val_total" param="val_total" value="" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <div class="btn-simpan">
                    <button type="submit" name="simpan" style="display: block; margin: auto; width: 150px;"
                    class="form-control btn-primary" id="btn-save"><i class="fas fa-save"></i> Simpan</button>
                </div>
            </div>
        </div>
    </div>
</form>
<!-- <form id="cobaa">
    <button type="submit">test</button>
</form> -->
<script>
// var rupiah = document.getElementById('val_subtotal');
// rupiah.addEventListener('click', function(e) {
//     rupiah.value = formatRupiah(this.value, 'Rp. ');
// });

// function formatRupiah(angka, prefix) {
//     var number_string = angka.replace(/[^,\d]/g, '')
//         .toString(),
//         split = number_string.split(','),
//         sisa = split[0].length % 3,
//         rupiah = split[0].substr(0, sisa),
//         ribuan = split[0].substr(sisa).match(/\d{3}/gi);

//     // tambahkan titik jika yang di input sudah menjadi angka ribuan
//     if (ribuan) {
//         separator = sisa ? '.' : '';
//         rupiah += separator + ribuan.join('.');
//     }
//     rupiah = split[1] != undefined ? rupiah + ',' +
//         split[1] : rupiah;
//     return prefix == undefined ? rupiah : (rupiah ?
//         'Rp. ' + rupiah : '');
// }





$(':input').click(function() {
    $(this).select();
});
// diskon master
$('#val_diskon_t').keyup(function() {
    if ($(this).val() == "") {
        $(this).val(0);
    }
});
$('#persen_master').click(function() {
    $('#val_diskon_t').attr('maxlength', '3');
    $('#val_diskon_t').attr('readonly', false);
    $('#persen_master').attr('class', 'btn btn-success w-80 form-control')
    $('#rupiah_master').attr('class', 'btn btn-secondary w-80 form-control')
});
$('#rupiah_master').click(function() {
    $('#val_diskon_t').attr('maxlength', '10');
    $('#val_diskon_t').attr('readonly', false);
    $('#rupiah_master').attr('class', 'btn btn-success w-80 form-control')
    $('#persen_master').attr('class', 'btn btn-secondary w-90 form-control')
});

// detail
$('#persen').click(function() {
    $('#diskon').attr('maxlength', '2');
    $('#diskon').attr('readonly', false);
    $('#persen').attr('class', 'btn btn-success')
    $('#rupiah').attr('class', 'btn btn-outline-secondary')
    $('#diskon').val('')
});

$('#rupiah').click(function() {
    $('#diskon').attr('maxlength', '12');
    $('#diskon').attr('readonly', false);
    $('#rupiah').attr('class', 'btn btn-success')
    $('#persen').attr('class', 'btn btn-outline-secondary')
    $('#diskon').val('')
});

function get_rp() {
    $('#diskon').attr('maxlength', '12');
    $('#diskon').attr('readonly', false);
    $('#rupiah').attr('class', 'btn btn-success')
    $('#persen').attr('class', 'btn btn-outline-secondary')
    $('#diskon').val('0')
    // $('#diskon').keyup(function() {
    //     $('#diskon').val().split('.').join('')
    //     this.value = parseFloat(this.value.replace(/,/g, ""))
    //         .toFixed(0)
    //         .replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1.')
    //     // .replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    //     // document.getElementById("number").value = this.value.replace(/,/g, "")
    // })
}

// function currencyFormat(num) {
//     return (num
//         .toFixed(0)
//         .replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1.')
//     );
// }
$('#diskon').blur(function() {
    if ($(this).val() == "") {
        $(this).val(0);
    } else {
        get_diskon();
    }
});

//data detail
var dt_final = [];
var dt_err=[];
$("#add-detail").click(function() {
    let row = $(this).attr('data-row');
    let aksi = $(this).attr('data-aksi');
    if (aksi == "tambah") {
        addRow();
    } else if (aksi == "ubah") {
        updateRow(row);
    }
    reload_tbl_tmp_dt();
    $(this).attr('data-row', '-1');
    $(this).attr('data-aksi', 'tambah');
    $('#val-kd-jenis').val('');
    $('#val_panjang').val('');
    $('#val_jumlah_berat').val('');
    $('#val_lebar').val('');
    $('#val_tinggi').val('');
    $('#hrg_volume').val('');
    $('#val_subtotal').val('');
    $('#diskon').val('');
    $('#val_total').val('');
    $('#jumlah-item').val('');


});



function addRow() {
    var object = {};
    let validation = true;
    $(".data-dt").each(function() {
        let name = $(this).attr("param");
        if ($(this).val() == "" || $(this).val() == "none") {
            validation = false;
            dt_err.push(name+'wajib diisi');
        } else {
            if (name!='val_diskon') {
                object[name] = $(this).val().split('.').join('');
            }else{
                object[name] = $(this).val();
            }
        }
    });
    if (validation) {
        dt_final.push(object);
    }
    // $(".data-dt").each(function() {
    //     let name = $(this).attr("param");
    //     object[name] = $(this).val();
    // });
    // dt_final.push(object);
}

function updateRow(row) {
    var object = {};
    $(".data-dt").each(function() {
        let name = $(this).attr("param");
        object[name] = $(this).val();
    });
    dt_final[row] = object;
    $("#add-detail").attr('data-row', '-1');
    $("#add-detail").attr('data-aksi', 'tambah');

}

function deleteRow(row) {
    dt_final.splice(row, 1);
}

function deleteNRefresh(row) {
    deleteRow(row);
    reload_tbl_tmp_dt();
}

function getRow(row) {
    $('#val_kd_jenis').val(dt_final[row]['val_kd_jenis']);
    $('#val_jumlah_berat').val(dt_final[row]['val_jumlah_berat']);
    $('#val_panjang').val(dt_final[row]['val_panjang']);
    $('#val_lebar').val(dt_final[row]['val_lebar']);
    $('#val_tinggi').val(dt_final[row]['val_tinggi']);
    $('#val_subtotal').val(dt_final[row]['val_subtotal']);
    $('#val_diskon').val(dt_final[row]['val_diskon']);
    $('#val_total').val(dt_final[row]['val_total']);
    $('#val_harga_berat').val(dt_final[row]['val_harga_berat']);
    $('#val_harga_volume').val(dt_final[row]['val_harga_volume']);
    $('#add-detail').attr('data-row', row);
    $('#add-detail').attr('data-aksi', 'ubah');
    $('#add-detail').html('Simpan Perubahan');
}

$('#frm-pengiriman').submit(function(e) {
    e.preventDefault();
    // $('#btn-save').prop('disabled',true);
    let loading_button = `
    <div style="width:50px">
    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
    <span class="sr-only">Loading...</span></div>`;
    e.preventDefault();
    $('#btn-save').prop('disabled',true);
    $('#btn-save').html(loading_button);
    dt_final=[];
    addRow();
    // console.log(dt_final);
    // alert('aaaaa');

    if (dt_err.length !== 0) {
        for (var i = 0; i < dt_err.length; i++) {
            alert(dt_err[i]);
        }
        $('#btn-save').prop('disabled',false);
    }else{
        form_data = new FormData($('#frm-pengiriman')[0]);
        form_data.append('token', '123');
        form_data.append('frm_table', 'pengiriman');
        for (var i = 0; i < dt_final.length; i++) {
            for (var property in dt_final[i]) {
                form_data.append(`detail[${i}][${property}]`, dt_final[i][property]);
            }
        }
        $.ajax({
            type: 'post',
            url: `<?= base_url() ?>/api/multi_insert`,
            data: form_data,
            dataType: 'json',
            cache: false,
            processData: false,
            contentType: false,
            enctype: 'multipart/form-data',
            success: function(r) {
                console.log(r);
                if (r.status == 200) {
                    tes_sweet('Simpan data berhasil');
                    location.href = `<?= base_url() ?>/load/view/pengiriman/pengiriman`;
                }
                // print_r($kirim);
            }
        });
    }
    
});
</script>

<?php
} elseif (isset($act) && $act == 'add' && $modal) {
    ?>

    <?php 
    $no=$last_start;
    foreach ($customer as $cs => $value) : ?>
        <input type="hidden" value="<?php echo $value->kd_customer ?>" id="customer-id-<?php echo $no ?>">
        <input type="hidden" value="<?php echo $value->nama ?>" id="customer-name-<?php echo $no ?>">
        <input type="hidden" value="<?php echo $value->alamat ?>" id="customer-alamat-<?php echo $no ?>">
        <input type="hidden" value="<?php echo $value->hp ?>" id="customer-hp-<?php echo $no ?>">
        <input type="hidden" value="<?php echo $value->kabupaten ?>" id="customer-kabupaten-<?php echo $no ?>">

        <button type="button" data-id="<?php echo $no ?>" class="btn btn-sm panggil" id="pilih-customer" data-dismiss="modal"
            data-key="<?= $value->kd_customer ?>"
            style="border: solid darkgray 1px; height: 80px; width: 100%; margin-top: 10px;">

            <div class="row">
                <div class="col-md-2 mt-4">
                    <!-- <?=$no ?> -->
                    <i class="fas fa-image text-center"></i>
                </div>
                <div class="col-md-3">
                    <li style="padding: 1px; font-size: 16px; text-align: left; list-style: none;">
                        <strong><?php echo $value->nama ?></strong>
                    </li>
                    <li style="padding: 1px; text-align: left; list-style: none;"><?php echo $value->hp ?></li>
                    <li style="padding: 1px; text-align: left; list-style: none;"><?php echo $value->kabupaten ?></li>
                </div>
            </div>
        </button>
        <?php 
        $no++;
    endforeach; 
    ?>
    <button style="width: 100%;color: navy" id="btn-load-more_<?=$no ?>" class="btn btn-light mt-2 mb-4" onclick="load_more_customer(`<?=($no) ?>`)">Load More</button>
    <script type="text/javascript">

        function load_more_customer(start){
            let key = $(this).data('key');
            let page = `<?= $page ?>`;
            let jenis = `pengiriman`;
            let jenis_modal = $(this).attr('id');
            let act = "add";
            let title_modal = "";
    // $('#start-customer').val(0);
    $('#btn-load-more_'+start).html(loading);
    $.ajax({
        type: 'POST',
        url: `<?= base_url() ?>/api/ajax_load_customer/`+start,
        data:{token:`<?=$_SESSION['token']?>`,file_name:`pengiriman/pengiriman/ajax_pengiriman`,page:page,jenis:jenis,act:act},
        success: function(r) {
            $('#btn-load-more_'+start).remove();
            // $('#m-crud-title-panggil').text(title_modal);
            // $('#m-customer').text(jenis_modal);
            $('#m-container-panggil').append(r);
            // $('#modal-panggil').modal('show');
            // $('#start-customer').val(10);
        }
    });
}
$('.panggil').on('click', function() {
    let key = $(this).data('key');
    let page = `<?= $page ?>`;
    let jenis = `<?= $jenis ?>`;
    // let jenis_modal = $(this).attr('id');
    let jenis_modal = $(this).attr('id');
    let title_modal = "";
    let id = $(this).data('id');
    let tujuan = $('#m-customer').text();
    if (tujuan == "pengirim") {
        // $('#val_kd_customer').val($("#customer-id-" + id).val());
        $('#kd-selected-pengirim').val($("#customer-id-" + id).val());
        $('#val_nama_pengirim').val($("#customer-name-" + id).val());
        $('#val_alamat_pengirim').val($("#customer-alamat-" + id).val());
        $('#val_kabupaten_pengirim').val($("#customer-kabupaten-" + id)
            .val());
        $('#val_hp_pengirim').val($("#customer-hp-" + id).val());
        $('#pengirim-text').text($("#customer-name-" + id).val());
    } else {
        // $('#val_kd_customer').val($("#customer-id-" + id).val());
        $('#kd-selected-penerima').val($("#customer-id-" + id).val());
        $('#val_nama_penerima').val($("#customer-name-" + id).val());
        $('#val_alamat_penerima').val($("#customer-alamat-" + id).val());
        $('#val_kabupaten_penerima').val($("#customer-kabupaten-" + id)
            .val());
        $('#val_hp_penerima').val($("#customer-hp-" + id).val());
        $('#penerima-text').text($("#customer-name-" + id).val());
    }
    cek_selected_customer();
});
</script>



<?php
} else {
    echo view('errors/html/error_404');
}
?>


</script>








<!-- <script>
const data = [];

const rows = () => {
    let html = '';
    for (let i = 0; i < data.length; i++) {
        html += `< tr >`;
        html += `< td >${i + 1}</td>`
        for (let j = 0; j < data[i].length; j++) {
            html += `< td >${data[i][j]}< /td>`;
        }
        html += `< /tr>`;
    }
    return html;
}

$('#btnSubmit').on('click', function(e) {
    const form = $(this).parent();
    form.on('click', function(e) {
        e.preventDefault()
    });

    form.find('input').val('tes');
    const inner = []
    $('form.form-horizontal :input').each(function(e) {
        if ($(this).val() !== '') {
            inner[e] = $(this).val()
        } else {
            alert('kosong cuy')
        }
    })
    data.push(inner)
    console.log(data);

    $('#table-detail tbody').html(rows());

});
</script> -->